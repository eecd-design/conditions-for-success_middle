---
import { getCollection } from "astro:content";

const { url } = Astro;
let path = url.pathname;

let allIndicators = await getCollection("indicators");
let indicators = allIndicators.sort((a, b) =>
	a.data.tag.localeCompare(b.data.tag),
);
---

<aside class="left section-nav-container">
	<nav class="section">
		<h2>The Big Seven</h2>
		<ul>
			<li>
				<a
					aria-current={path === "/big-seven" ? "page" : null}
					href="/big-seven">Introduction</a
				>
			</li>
			{
				indicators.map((indicator) => {
					let indicatorPath = `/big-seven/${indicator.id}`;
					return (
						<li>
							<a
								aria-current={
									path === indicatorPath ? "page" : null
								}
								href={indicatorPath}
							>
								{indicator.data.title}
							</a>
						</li>
					);
				})
			}
		</ul>
	</nav>
</aside>

<style is:global>
	nav.section h2 {
		font-size: var(--font-size-lg);
		border-bottom: 1px solid var(--colour-border-neutral-subtle);
		padding: 0 0 var(--space-2xs);
		margin: 0 0 var(--space-sm);
	}

	nav.section ul {
		display: flex;
		flex-flow: column;
		gap: var(--space-2xs);
		margin: 0;
		padding: 0;
		list-style-type: none;
	}

	nav.section ul ul {
		display: flex;
		flex-flow: column;
		gap: var(--space-2xs);
		margin-top: var(--space-2xs);
	}

	nav.section ul li {
		line-height: 1.2;
	}

	nav.section a {
		display: flex;
		align-items: center;
		text-decoration: none;
		padding: var(--space-xs) var(--space-sm);
		font-size: var(--font-size-xs);
		line-height: 1.2;
		border-radius: var(--border-radius-normal);
	}

	nav.section a:is(:hover, :focus-visible) {
		background-color: var(--colour-fill-neutral-subtle);
		color: var(--colour-ui-neutral);
	}

	nav.section [aria-current="page"],
	nav.section [aria-current="page"]:is(:hover, :focus-visible) {
		outline: 2px solid var(--colour-border-neutral-subtle);
		outline-offset: -1px;
		background-color: transparent;
	}
</style>
